<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <meta content="â–€â–„â–€â–„â–€â–„ art, music, code â–„â–€â–„â–€â–„â–€" name="description"/>
    <meta content="art, music, code" name="keywords"/>
    <meta content="Brandon Stone" name="author"/>
    <meta content="ðŸ¡" property="og:title"/>
    <meta content="website" property="og:type"/>
    <meta content="https://brandonstone.cc/" property="og:url"/>
    <meta content="â–€â–„â–€â–„â–€â–„ art, music, code â–„â–€â–„â–€â–„â–€" property="og:description"/>
    <title>ephemera catalogue</title>

    <link href="/src/favicon/favicon.ico" rel="icon"/>
    <link href="/style.css" media="all" rel="stylesheet" type="text/css"/>
    <script src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js" type="module"></script>

    <style>
        .swappable-image {
            width: 333px;
            height: 333px;
            max-width: 100%;
            object-fit: cover;
            display: block;
        }

        /* Mobile styles */
        @media screen and (max-width: 768px) {
            .swappable-image {
                width: 15%;
                height: auto;
                aspect-ratio: 1 / 1;
                min-width: 50px;
                max-width: 100px;
            }
        }
    </style>
    <script src="/currentlyreading.js"></script>

</head>

<body>
<div class="homenavcontainer">
    <header>
        <h1>
            <a class="headerlink" href="/index.html">scans</a>
        </h1>
        <nav>
            <div class="navsection">
                <a href="/index.html">scatter view</a>
                <a href="/ramblings.html">random thoughts</a>
                <a href="https://barndoors.cc">continue to main site</a>
            </div>
        </nav>
    </header>
    <div class="currently-reading-container"></div>
</div>
<main id="content">
    <!-- Content will be dynamically generated here -->
</main>

<script src="/gallery.js"></script>
<script>
    // Fisher-Yates shuffle algorithm
    function shuffleArray(array) {
        const shuffled = [...array]; // Create a copy
        for (let i = shuffled.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
        }
        return shuffled;
    }

    document.addEventListener('DOMContentLoaded', function() {
        // Category mapping based on folder structure in gallery.js
        const categories = {
            'cards': 'cards',
            'crafted': 'crafted',
            'events': 'events',
            'food': 'food',
            'lotto': 'lotto',
            'pocket': 'pocket',
            'print': 'print',
            'textures': 'textures',
            'transit': "transit"
        };

        // Group images by category
        const groupedImages = {};
        images.forEach(image => {
            // Extract category from src path
            const pathParts = image.src.split('/');
            const categoryFolder = pathParts.find(part => Object.keys(categories).includes(part));
            const category = categories[categoryFolder] || 'Other';

            if (!groupedImages[category]) {
                groupedImages[category] = [];
            }
            groupedImages[category].push(image);
        });

        // Shuffle items within each category
        Object.keys(groupedImages).forEach(category => {
            groupedImages[category] = shuffleArray(groupedImages[category]);
        });

        const content = document.getElementById('content');

        // Get category keys and shuffle them
        const shuffledCategoryKeys = shuffleArray(Object.keys(categories));

        // Generate HTML for each category in random order
        shuffledCategoryKeys.forEach(categoryKey => {
            const categoryName = categories[categoryKey];
            const categoryImages = groupedImages[categoryName];

            if (!categoryImages || categoryImages.length === 0) return;

            // Create category section
            const categoryHTML = `
                <hr/>
                <h3>${categoryName}</h3>
            `;

            content.insertAdjacentHTML('beforeend', categoryHTML);

            // Add each image in the category (already shuffled)
            categoryImages.forEach(image => {
                const articleHTML = `
                    <div class="article">
                        <div class="article-content">
                            <img src="${image.src}"
                                 alt="${image.title}"
                                 class="swappable-image"
                                 data-hover="${image.fullSrc}"/>
                            <div class="article-text">
                                <p>
                                    ${image.description.replace(/\n/g, '<br>')}
                                </p>
                            </div>
                        </div>
                    </div>
                    <br>
                `;

                content.insertAdjacentHTML('beforeend', articleHTML);
            });
        });

        // Set up hover functionality for swappable images
        const swappableImages = document.querySelectorAll('.swappable-image');
        swappableImages.forEach(function(image) {
            const originalSrc = image.src;
            const hoverSrc = image.dataset.hover;

            if (hoverSrc) {
                image.addEventListener('mouseenter', function() {
                    this.src = hoverSrc;
                });

                image.addEventListener('mouseleave', function() {
                    this.src = originalSrc;
                });
            }
        });
    });
</script>
</body>
</html>