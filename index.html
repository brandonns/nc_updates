<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <meta name="description" content="▀▄▀▄▀▄ art, music, code ▄▀▄▀▄▀"/>
    <meta name="keywords" content="art, music, code"/>
    <meta name="author" content="Brandon Stone"/>
    <meta property="og:title" content="🏡"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://brandonstone.cc/"/>
    <meta property="og:description" content="▀▄▀▄▀▄ art, music, code ▄▀▄▀▄▀"/>
    <title>ephemera</title>

    <link href="/src/favicon/favicon.ico" rel="icon"/>
    <link href="/style.css" media="all" rel="stylesheet" type="text/css"/>
    <script src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js" type="module"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            overscroll-behavior: none;
            touch-action: none;
            overflow-x: hidden;
            min-height: 100vh;
            position: relative;
            font-family: "Azeret Mono", serif;
            background: #D0CEBA;
        }

        .glass-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            transition: backdrop-filter 0.3s ease;
        }

        .glass-overlay.blurred {
            backdrop-filter: blur(40px) saturate(200%);
            background: #D0CEBA;
        }

        header, main {
            padding: 1rem;
        }

        main, nav {
            overflow-y: auto;
        }

        header {
            position: relative;
            z-index: 10;
            background-color: transparent;
        }

        header h1 {
            margin: 0 0 1rem;
        }

        .homenavcontainer {
            display: flex;
            justify-content: space-between;
            flex-direction: row;
            flex-wrap: wrap;
            width: 100%;
            background-color: transparent;
        }

        .navsection {
            display: inline-block;
        }

        .navsection p, .navsection a {
            font-size: 16px;
        }

        nav a {
            text-decoration: none;
        }

        h1, h2, h3, nav a, nav p {
            font-weight: normal;
            text-transform: uppercase;
        }

        nav a, nav a:visited {
            color: var(--primary);
        }

        nav a:hover {
            color: var(--text);
            text-decoration: underline;
        }

        a.headerlink {
            color: var(--text);
            text-decoration: none;
        }

        p, a {
            line-height: 120%;
        }

        a, a:visited {
            color: var(--primary);
        }

        .gallery-container {
            position: relative;
            z-index: 1;
            width: 300vw;
            height: 300vh;
            padding: 50px;
            padding-top: 120px;
            cursor: grab;
            transition: transform 0.1s ease-out;
        }

        .gallery-container:active {
            cursor: grabbing;
        }

        .viewport {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            z-index: 1;
        }

        .image-item {
            position: absolute;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            width: 222px;
            height: 222px;
        }

        .image-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .image-item:hover {
            transform: scale(1.05) rotate(2deg);
            z-index: 10;
        }

        .image-item:hover img {
            transform: scale(1.1);
        }

        .tooltip {
            position: absolute;
            background: #D0CEBA;
            backdrop-filter: blur(10px);
            padding: 15px;
            pointer-events: none;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s ease;
            z-index: 20;
            min-width: 200px;
            border: 1px solid #417B5A;
        }

        .tooltip.show {
            opacity: 1;
            transform: translateY(0);
        }

        .tooltip-image {
            width: 80px;
            height: 80px;
            object-fit: cover;
            margin-bottom: 10px;
        }

        .tooltip-title {
            font-weight: bold;
            color: #4B3F72;
            font-size: 14px;
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(20px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 100;
            animation: modalFadeIn 0.3s ease;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            display: flex;
            max-width: 90%;
            max-height: 90%;
            background: rgba(208, 206, 186, 0.1);
            backdrop-filter: blur(20px);
            overflow: hidden;
            border: 1px solid rgba(65, 123, 90, 0.2);
        }

        .modal-image {
            max-width: 70%;
            max-height: 100%;
            object-fit: contain;
        }

        .modal-info {
            padding: 40px;
            color: #D0CEBA;
            min-width: 300px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .modal-title {
            font-family: "Jacquarda Bastarda 9", serif;
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 20px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }

        .modal-description {
            font-family: "Azeret Mono", serif;
            font-size: clamp(12px, 2.5vw, 16px);
            line-height: 1.6;
            opacity: 0.9;
            white-space: pre-line;
            overflow-wrap: break-word;
            hyphens: auto;
        }

        .close-modal {
            position: absolute;
            top: 30px;
            right: 30px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            font-size: 24px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .close-modal:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        @media (max-width: 768px) {
            .gallery-container {
                padding: 20px;
                padding-top: 100px;
            }

            .homenavcontainer header {
                flex-direction: column;
                gap: 10px;
                padding: 10px 20px;
            }

            .navsection {
                gap: 15px;
            }

            #currentlyReading {
                display: none;
            }

            .modal-content {
                flex-direction: column;
                max-width: 95%;
            }

            .modal-image {
                max-width: 100%;
                max-height: 40vh;
                height: auto;
                object-fit: contain;
            }

            .modal-info {
                min-width: auto;
                padding: 20px;
            }
            .tooltip {
                display: none !important;
            }
            #closeModal {
                display: none !important;
            }
            .image-item {
                width: 150px;   /* Reduced from default 222px */
                height: 150px;  /* Reduced from default 222px */
            }

        }

    </style>
</head>
<body>
<div class="liquid-background"></div>
<div class="glass-overlay" id="glassOverlay"></div>

<div class="homenavcontainer">
    <header>
        <h1>
            <a class="headerlink" href="/index.html">scans</a>
        </h1>
        <nav>
            <div class="navsection">
                <a href="/catalogue.html">list view</a>
                <a href="/ramblings.html">random thoughts</a>
                <a href="https://barndoors.cc">continue to main site</a>
            </div>
        </nav>
    </header>
    <div id="currentlyReading" style="width: 33%; float: right; position: relative; text-align: center;">
        <p style="width: 100%; margin: 0; padding: 5px 0;">currently reading</p>
        <model-viewer
                auto-rotate=""
                auto-rotate-delay="0"
                camera-controls=""
                camera-orbit="125deg 75deg 0.6m"
                field-of-view="25deg"
                interaction-prompt="none"
                poster="/src/poster.webp"
                shadow-intensity="0"
                src="/src/book.glb"
                style="width: 100%;
                    max-width: 250px;
                    margin: 0 auto;">
            <div slot="progress-bar"></div>
        </model-viewer>
    </div>
</div>

<div class="viewport">
    <div class="gallery-container" id="galleryContainer">
    </div>
</div>

<div class="tooltip" id="tooltip">
    <img class="tooltip-image" id="tooltipImage" src="" alt="">
    <div class="tooltip-title" id="tooltipTitle"></div>
</div>

<div class="modal" id="modal">
    <button class="close-modal" id="closeModal">&times;</button>
    <div class="modal-content">
        <img class="modal-image" id="modalImage" src="" alt="">
        <div class="modal-info">
            <div class="modal-title" id="modalTitle"></div>
            <div class="modal-description" id="modalDescription"></div>
        </div>
    </div>
</div>

<script>
    const images = [
        {
            src: '/src/scans%20edited/1transportation/fukuokapass.png',
            fullSrc: '/src/scans/1transportation/fukuokapass.png',
            title: 'Hayakaken (はやかけん)',
            description: `Hayakaken (はやかけん) transit card.
                    Used to get around Fukuoka (福岡市) public transport.`
        },
        {
            src: '/src/scans%20edited/1transportation/kchildsbuspass.png',
            fullSrc: '/src/scans/1transportation/kchildsbuspass.png',
            title: 'Incheon (인천) Child\'s Bus Pass',
            description: `Child's bus pass for Incheon (인천) transit.
                    What I used to get around while visiting family back in the day.`
        },
        {
            src: '/src/scans%20edited/1transportation/njtransit.png',
            fullSrc: '/src/scans/1transportation/njtransit.png',
            title: 'NJ Transit ticket',
            description: `Ticket for the trip from EWR to Princeton.
            This was for a hackathon I took part in back in college.`
        },
        {
            src: '/src/scans%20edited/1transportation/parking28.png',
            fullSrc: '/src/scans/1transportation/parking28.png',
            title: 'No. 6328',
            description: `Parking Permit Number 6328.
                    My first parking permit. I never saw security checking these.`
        },
        {
            src: '/src/scans%20edited/1transportation/parking52.png',
            fullSrc: '/src/scans/1transportation/parking52.png',
            title: 'No. 6652',
            description: `Parking Permit Number 6652.
                    My second parking permit. Interestingly, no fine print up top. I wonder if they really only handed out 324 in that time.`
        },
        {
            src: '/src/scans%20edited/2food/cheapapplefruitpie.png',
            fullSrc: '/src/scans/2food/cheapapplefruitpie.png',
            title: 'Square Snack',
            description: `Little Debbie mini apple fruit pie wrapper.
                    One of my buddies has NEVER had one of these, apparently. Impulse buy at the grocery store`
        },
        {
            src: '/src/scans%20edited/2food/mcdouble13e.png',
            fullSrc: '/src/scans/2food/mcdouble13.png',
            title: 'McDouble Order Number 13',
            description: `Ticket from a Friday, Jun 6, 2025 drive-thru order.
Rare \`SUB Mac Sauce\` modifier note.
Lucky number 13 from side 2.`
        },
        {
            src: '/src/scans%20edited/2food/mcdouble69e.png',
            fullSrc: '/src/scans/2food/mcdouble69.png',
            title: 'McDouble Order Number 69',
            description: `Ticket from a Wednesday, Jun 18, 2025 drive-thru order.
Confusingly standard \`ONLY\` modifier notes with an \`ADD Mac Sauce\`.
Side 1 bringing the NICE order number 69.`
        },
        {
            src: '/src/scans%20edited/3entry/diamondhead.png',
            fullSrc: '/src/scans/3entry/diamondhead.png',
            title: 'Diamond Head',
            description: `Diamond Head State Monument entry ticket.
                    Hawaii is so dang pretty.`
        },
        {
            src: '/src/scans%20edited/3entry/kenspacecenter.png',
            fullSrc: '/src/scans/3entry/kenspacecenter.png',
            title: 'Kennedy Space Center',
            description: `Kennedy Space Center Adult Admission ticket.
                    "SPAAAACE!"`
        },
        {
            src: '/src/scans%20edited/3entry/lama.png',
            fullSrc: '/src/scans/3entry/lama.png',
            title: '14th Dalai Lama',
            description: `14th Dalai Lama Speech GE ticket.
                    Honestly, I only remember one of these CU speaker night things.`
        },
        {
            src: '/src/scans%20edited/3entry/officepass.png',
            fullSrc: '/src/scans/3entry/officepass.png',
            title: 'Office Badge',
            description: `My office badge.
                    Back when we had offices to work in. Uncomfortably thick.`
        },
        {
            src: '/src/scans%20edited/3entry/schoolid.png',
            fullSrc: '/src/scans/3entry/schoolid.png',
            title: 'Office Badge',
            description: `The back of my Sr. year school ID.
                    Rowland's class was "Weights for Athletes III".`
        },
        {
            src: '/src/scans%20edited/3entry/stateofsatire.png',
            fullSrc: '/src/scans/3entry/stateofsatire.png',
            title: 'State of Satire',
            description: `State of Satire GE ticket.
                    Another CU speaker night thing. I wonder what this speech would look like today.`
        },
        {
            src: '/src/scans%20edited/3entry/woz.png',
            fullSrc: '/src/scans/3entry/woz.png',
            title: 'The Woz',
            description: `An Evening with Steve Wozniak GE ticket.
                    The one CU speaker night thing I somewhat remember. Basically an hour of dunking on Jobs.`
        },
        {
            src: '/src/scans%20edited/4games/rodsmith.png',
            fullSrc: '/src/scans/4games/rodsmith.png',
            title: 'HOF',
            description: `Rod Smith's autograph.
                    I went to a pool party at his house.`
        },
        {
            src: '/src/scans%20edited/4games/voidlottoe.png',
            fullSrc: '/src/scans/4games/voidlotto.png',
            title: 'Void Not For Sale',
            description: `A fun *VOID* ticket I got. Obvious loser.`
        },
        {
            src: '/src/scans%20edited/5reference/couponinktest.png',
            fullSrc: '/src/scans/5reference/couponinktest.png',
            title: 'Coupon CMYK Test',
            description: `King Soopers coupon printer test.
                    Very thin lines. Interesting there seems to be a focus on diagonal lines.`
        },
        {
            src: '/src/scans%20edited/5reference/covid.png',
            fullSrc: '/src/scans/5reference/covid.png',
            title: 'COVID-19 Vaxxer',
            description: `COVID-19 Vaccination Record Card [redacted].
                    Remember all that? Moderna or bust.`
        },
        {
            src: '/src/scans%20edited/5reference/feedbackloopintroe.png',
            fullSrc: '/src/scans/5reference/feedbackloopintro.png',
            title: 'Strange Loop Users Manual',
            description: `Intro from the Strange Loop users manual.
                    Short blurb about feedback loops. I like the little visual.`
        },
        {
            src: '/src/scans%20edited/5reference/vidglitcher.png',
            fullSrc: '/src/scans/5reference/vidglitcher.png',
            title: 'Video Breaker User Guide',
            description: `Diagram of internals from the Video Breaker User Guide.
                    Not a hardware guy but this is neat.`
        },
        {
            src: '/src/scans%20edited/6trading_cards/apache.png',
            fullSrc: '/src/scans/6trading_cards/apache.png',
            title: 'Apache Attack \'Copter',
            description: `Apache Attack 'Copter card from the Topps Desert Storm trading card pack.
                    7 player killstreak! (6 with Hardline).`
        },
        {
            src: '/src/scans%20edited/6trading_cards/apc.png',
            fullSrc: '/src/scans/6trading_cards/apc.png',
            title: 'Marine APCs',
            description: `Marine APCs card from the Topps Desert Storm trading card pack.
                    Armored Personnel Carriers traditionally carry personnel. Neat chassis.`
        },
        {
            src: '/src/scans%20edited/6trading_cards/cyborge.png',
            fullSrc: '/src/scans/6trading_cards/cyborg.png',
            title: 'Cyborg',
            description: `Cyborg (Victor Stone) trading card from Dave & Busters.
                    Another random coin-dropper prize.`
        },
        {
            src: '/src/scans%20edited/6trading_cards/desertstormcardse.png',
            fullSrc: '/src/scans/6trading_cards/desertstormcards.png',
            title: 'Topps Desert Storm',
            description: `Topps Desert Storm trading card pack wrapper.
                    Random pickup for myself while doing some gift shopping a few years ago.`
        },
        {
            src: '/src/scans%20edited/6trading_cards/dragonitee.png',
            fullSrc: '/src/scans/6trading_cards/dragonite.png',
            title: 'Delivery Dragonite',
            description: `Pokémon WotC Promo Dragonite #5.
                    Absolute favorite Pokémon and very neat card. I'm old enough to have gotten this card at the movies. I don't remember a single thing, but I kept the card.`
        },
        {
            src: '/src/scans%20edited/6trading_cards/mlrs.png',
            fullSrc: '/src/scans/6trading_cards/mlrs.png',
            title: 'MLRS',
            description: `Multi-launch Rocket System card from the Topps Desert Storm trading card pack.
                    Each rocket is 13' long with a 9" diameter.`
        },
        {
            src: '/src/scans%20edited/6trading_cards/spocke.png',
            fullSrc: '/src/scans/6trading_cards/spock.png',
            title: 'Bones',
            description: `Dr. Leonard H. McCoy ("Bones") trading card from Dave & Busters.
                    No full sets from my last visit.`
        },
        {
            src: '/src/scans%20edited/6trading_cards/topgun.png',
            fullSrc: '/src/scans/6trading_cards/topgun.png',
            title: 'Top Gun',
            description: `Top Gun card from the Topps Desert Storm trading card pack.
                    [Comment removed by Tom Cruise's agent, Maha Dakhil].`
        },
        {
            src: '/src/scans%20edited/6trading_cards/whatatank.png',
            fullSrc: '/src/scans/6trading_cards/whatatank.png',
            title: 'What Is A Tank?',
            description: `What Is A Tank? card from the Topps Desert Storm trading card pack.
                    Carries a large, direct-fire cannon; heavily armored.`
        },
        {
            src: '/src/scans%20edited/7textures/fieldnotesmape.png',
            fullSrc: '/src/scans/7textures/fieldnotesmap.png',
            title: 'Field Notes National Park Pack',
            description: `Field Notes box interior.
                    I love the Grand Canyon. Pretty neat to see and the surrounding area is beautiful.`
        },
        {
            src: '/src/scans%20edited/7textures/mountainsfromapplewatchbande.png',
            fullSrc: '/src/scans/7textures/mountainsfromapplewatchband.png',
            title: 'Alpine Loop',
            description: `Apple Watch Band box interior.
                    Moody.`
        },
        {
            src: '/src/scans%20edited/7textures/postcard.png',
            fullSrc: '/src/scans/7textures/postcard.png',
            title: 'Postcard from Rob',
            description: `Postcard from Rob.
                    Love ya bro!`
        },
        {
            src: '/src/scans%20edited/7textures/savethebees.png',
            fullSrc: '/src/scans/7textures/savethebees.png',
            title: 'Save the Bees!',
            description: `Save the Bees, cut from t-shirt.
                    I forget why this shirt ended up like this.`
        },
        {
            src: '/src/scans%20edited/7textures/sonystickers.png',
            fullSrc: '/src/scans/7textures/sonystickers.png',
            title: 'Cassette Stickers',
            description: `Stickers from a Sony camcorder cassette tape.
                    I bought a small stack of tapes before finding out my camcorder tape drawer was stuck.`
        },
        {
            src: '/src/scans%20edited/8literature/dbzone.png',
            fullSrc: '/src/scans/8literature/dbzone.png',
            title: 'Cross Epoch Panel',
            description: `Intro panel from Cross Epoch.
                    I got this from one of the One Piece box sets. Very fun One Piece x Dragon Ball collab.`
        },
        {
            src: '/src/scans%20edited/8literature/opfeast.png',
            fullSrc: '/src/scans/8literature/opfeast.png',
            title: 'Cross Epoch Panel',
            description: `Panel from Cross Epoch.
                    From the same mini-volume. This is from the One Piece x Toriko story.`
        },
        {
            src: '/src/scans%20edited/8literature/opocean.png',
            fullSrc: '/src/scans/8literature/opocean.png',
            title: 'The Solitary Journey of Jimbei Panel',
            description: `Panel from The Solitary Journey of Jimbei.
                    Another mini-volume from another box set. Jimbei in the water.`
        },
        {
            src: '/src/scans%20edited/8literature/si_dec1982e.png',
            fullSrc: '/src/scans/8literature/si_dec1982.png',
            title: 'Scientific American. (1982, December). 247(6)',
            description: `Personal favorite cover from a small stash recovered from the
                    trash outside an office in the CU Boulder Engineering Center.`
        },
        {
            src: '/src/scans%20edited/8literature/zenitsu.png',
            fullSrc: '/src/scans/8literature/zenitsu.png',
            title: 'Zenitsu Agatsuma (我妻 善逸)',
            description: `Profile for Zenitsu Agatsuma from the Demon Slayer Corps Special Report mini-volume.
                    One of my favorite characters from Demon Slayer.`
        },
    ];


    const galleryContainer = document.getElementById('galleryContainer');
    const tooltip = document.getElementById('tooltip');
    const modal = document.getElementById('modal');
    const glassOverlay = document.getElementById('glassOverlay');

    let isDragging = false;
    let startX, startY;
    let currentX = 0, currentY = 0;
    let initialX = 0, initialY = 0;




    function isOverlappingEnough(x1, y1, w1, h1, x2, y2, w2, h2, maxOverlapRatio = 0.15) {
        const left = Math.max(x1, x2);
        const top = Math.max(y1, y2);
        const right = Math.min(x1 + w1, x2 + w2);
        const bottom = Math.min(y1 + h1, y2 + h2);

        const overlapWidth = Math.max(0, right - left);
        const overlapHeight = Math.max(0, bottom - top);
        const overlapArea = overlapWidth * overlapHeight;

        const imageArea = w1 * h1;
        return (overlapArea / imageArea) < maxOverlapRatio;
    }


    function createScatteredGallery() {
        const canvasWidth = window.innerWidth * 3;
        const canvasHeight = window.innerHeight * 3;

        // Image dimensions for overlap calculation
        const isMobile = window.innerWidth < 1000;
        const imageWidth = isMobile ? 150 : 333;
        const imageHeight = isMobile ? 150 : 333;
        const maxOverlap = 0.1; // 20% maximum overlap allowed
        const minDistance = isMobile ? imageWidth * 2.4 : imageWidth * (1 - maxOverlap);
        const placedImages = [];

        let firstImagePosition = null;

        images.forEach((img, index) => {
            const imageItem = document.createElement('div');
            imageItem.className = 'image-item';

            let x, y, attempts = 0;


            let validPosition = false;

            // Try to find a position with acceptable overlap
            while (!validPosition && attempts < 100) {
                // Use the ENTIRE canvas but with a very slight center bias
                // 85% chance of uniform distribution, 15% chance of center-biased
                if (Math.random() < 0.85) {
                    // Uniform distribution across entire canvas
                    x = Math.random() * (canvasWidth - imageWidth);
                    y = Math.random() * (canvasHeight - imageHeight);
                } else {
                    // Slight center bias - within middle 70% of canvas
                    const centerX = canvasWidth / 2;
                    const centerY = canvasHeight / 2;
                    const biasRadiusX = canvasWidth * 0.5; // 70% width from center
                    const biasRadiusY = canvasHeight * 0.5; // 70% height from center

                    x = centerX - biasRadiusX + Math.random() * (biasRadiusX * 2) - imageWidth/2;
                    y = centerY - biasRadiusY + Math.random() * (biasRadiusY * 2) - imageHeight/2;

                    x = Math.max(0, Math.min(canvasWidth - imageWidth, x));
                    y = Math.max(0, Math.min(canvasHeight - imageHeight, y));
                }

                validPosition = true;
                for (let placed of placedImages) {
                    if (!isOverlappingEnough(
                        x, y, imageWidth, imageHeight,
                        placed.x, placed.y, imageWidth, imageHeight
                    )) {
                        validPosition = false;
                        break;
                    }

                }
                attempts++;
            }
            if (index === 0) {
                firstImagePosition = { x, y };
            }
            if (!validPosition) {
                // Space is too crowded, so just offset slightly from a previous image
                const fallback = placedImages[Math.floor(Math.random() * placedImages.length)];
                x = fallback.x + minDistance * (Math.random() - 0.5);
                y = fallback.y + minDistance * (Math.random() - 0.5);
            }


            placedImages.push({ x, y, element: imageItem });

            const rotation = (Math.random() - 0.5) * 30;

            imageItem.style.left = x + 'px';
            imageItem.style.top = y + 'px';
            imageItem.style.transform = `rotate(${rotation}deg)`;

            const imgElement = document.createElement('img');
            imgElement.src = img.src;
            imgElement.alt = img.title;

            imageItem.appendChild(imgElement);
            galleryContainer.appendChild(imageItem);

            setupImageEvents(imageItem, img, index);
        });

        const offsetX = -window.innerWidth;
        const offsetY = -window.innerHeight;
        currentX = offsetX;
        currentY = offsetY;
        galleryContainer.style.transform = `translate(${offsetX}px, ${offsetY}px)`;


        if (placedImages.length > 0) {
            const randomIndex = Math.floor(Math.random() * placedImages.length);
            const targetImage = placedImages[randomIndex];

            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;

            const targetX = centerX - (targetImage.x + imageWidth / 2);
            const targetY = centerY - (targetImage.y + imageHeight / 2);

            currentX = targetX;
            currentY = targetY;

            galleryContainer.style.transition = 'none';
            galleryContainer.style.transform = `translate(${currentX}px, ${currentY}px)`;
        }


    }

    function handleDragStart(e) {
        if (e.target.closest('.image-item')) return;

        isDragging = true;
        galleryContainer.style.cursor = 'grabbing';
        galleryContainer.style.transition = 'none';

        if (e.type === 'mousedown') {
            startX = e.clientX - currentX;
            startY = e.clientY - currentY;
        } else {
            startX = e.touches[0].clientX - currentX;
            startY = e.touches[0].clientY - currentY;
        }
    }

    function handleDragMove(e) {
        if (!isDragging) return;

        e.preventDefault();

        if (e.type === 'mousemove') {
            currentX = e.clientX - startX;
            currentY = e.clientY - startY;
        } else {
            currentX = e.touches[0].clientX - startX;
            currentY = e.touches[0].clientY - startY;
        }

        const maxX = window.innerWidth * 0.5;
        const maxY = window.innerHeight * 0.5;
        const minX = -(window.innerWidth * 2.5);
        const minY = -(window.innerHeight * 2.5);

        currentX = Math.max(minX, Math.min(maxX, currentX));
        currentY = Math.max(minY, Math.min(maxY, currentY));

        galleryContainer.style.transform = `translate(${currentX}px, ${currentY}px)`;
    }

    function handleDragEnd() {
        isDragging = false;
        galleryContainer.style.cursor = 'grab';
        galleryContainer.style.transition = 'transform 0.1s ease-out';
    }

    galleryContainer.addEventListener('mousedown', handleDragStart);
    document.addEventListener('mousemove', handleDragMove);
    document.addEventListener('mouseup', handleDragEnd);

    galleryContainer.addEventListener('touchstart', handleDragStart);
    document.addEventListener('touchmove', handleDragMove);
    document.addEventListener('touchend', handleDragEnd);

    function setupImageEvents(imageItem, imgData, index) {
        const isMobile = window.matchMedia("(max-width: 768px)").matches;

        if (!isMobile) {
            imageItem.addEventListener('mouseenter', (e) => {
                showTooltip(e, imgData);
            });

            imageItem.addEventListener('mouseleave', () => {
                hideTooltip();
            });

            imageItem.addEventListener('mousemove', (e) => {
                updateTooltipPosition(e);
            });
        }

        // Always allow modal on click/tap
        imageItem.addEventListener('click', () => {
            showModal(imgData);
        });
    }


    function showTooltip(e, imgData) {
        const tooltipImage = document.getElementById('tooltipImage');
        const tooltipTitle = document.getElementById('tooltipTitle');

        tooltipImage.src = imgData.fullSrc;
        tooltipTitle.textContent = imgData.title;

        tooltip.classList.add('show');
        updateTooltipPosition(e);
    }

    function hideTooltip() {
        tooltip.classList.remove('show');
    }

    function updateTooltipPosition(e) {
        const rect = tooltip.getBoundingClientRect();
        let x = e.clientX + 15;
        let y = e.clientY - rect.height - 15;

        if (x + rect.width > window.innerWidth) {
            x = e.clientX - rect.width - 15;
        }
        if (y < 0) {
            y = e.clientY + 15;
        }

        tooltip.style.left = x + 'px';
        tooltip.style.top = y + 'px';
    }

    function showModal(imgData) {
        const modalImage = document.getElementById('modalImage');
        const modalTitle = document.getElementById('modalTitle');
        const modalDescription = document.getElementById('modalDescription');

        modalImage.src = imgData.fullSrc || imgData.src;
        modalTitle.textContent = imgData.title;
        modalDescription.textContent = imgData.description;

        modal.style.display = 'flex';
        glassOverlay.classList.add('blurred');
        document.body.style.overflow = 'hidden';
    }

    function hideModal() {
        modal.style.display = 'none';
        glassOverlay.classList.remove('blurred');
        document.body.style.overflow = 'auto';
    }

    document.getElementById('closeModal').addEventListener('click', hideModal);
    modal.addEventListener('click', (e) => {
        if (e.target === modal) {
            hideModal();
        }
    });

    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
            hideModal();
            hideTooltip();
        }
    });

    window.addEventListener('resize', () => {
        galleryContainer.innerHTML = '';
        currentX = 0;
        currentY = 0;
        galleryContainer.style.transform = 'translate(0px, 0px)';
        createScatteredGallery();
    });
    document.addEventListener('touchmove', handleDragMove, { passive: false });
    createScatteredGallery();
</script>
</body>
</html>